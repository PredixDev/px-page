<!-- TODO: Dependencies -->
<link rel="import" href="../polymer/polymer.html"/>

<!-- TODO: px components
<link rel="import" href="../pg-card/pg-card.html"/>
-->
<link rel="import" href="../px-card/px-deck.html"/>
<link rel="import" href="../px-card/px-card.html"/>

<link rel="import" href="../px-mobile/px-mobile.html"/>


<!--
<link rel="stylesheet" href="px-page.css"/>
# Overview
This provides a wrapper for px-deck and px-card elements.

### Page Data Properties
page.name	Contains string value of data-page attribute
page.url	Contains string URL of just loaded page
page.query	object with URL query parameters. If your page URL is "about.html?id=10&count=20&color=blue" then page.query will contain:
{
  id: '10',
  count: '20',
  color: 'blue'
}
page.view	object. View instance that contains this page (if this View was initialized)
page.container	Link to Page HTMLElement
page.from	string - direction of where Page comes from. It will be "right" if you load new page, and "left" - if page comes after you click on "Back" button
page.navbarInnerContainer	Link to related "navbar-inner" HTMLElement. Only for Dynamic Navbars
page.swipeBack	boolean. Equals to true if page animation was initiated by swipe back. Available only within onPageBefore/AfterAnimation callbacks/events.
page.context	object. Template7 context that was passed for this page when using Template7 pages
page.fromPage	object. Page Data object of the previously active page

## Usage
To use this component in your custom component do the following:

```
<dom-module id="demo-view">
  <template>
    <px-page id="demo-card-view">
      <px-card header-text="Sample Card">
        Card content
      <px-card>
    </px-page>
  </template>
</dom-module>
<script>
  Polymer({
  is: 'demo-view',
    init: function(){
      // this is where you can do some initialization of your card
    },
    behaviors: [px.view]
  });
</script>
```
@element px-page
@blurb Element containing basic styling and behaviors (API) for card
@demo demo.html
@homepage index.html
-->
<dom-module id="px-page">
  <style>

  :host {
    display: block;
    -webkit-transition: all 0.5s;
    transition: all 0.5s;
    box-sizing: border-box;
    position: absolute;
    min-height: 50vh;
    -webkit-transform: translate3d(0,0,0);
    transform: translate3d(0,0,0);
  }

  /* TODO: Grid Styles */
  :host .page-content > ::content section {
    display: flex;
    flex-wrap: wrap;
    align-items: stretch;
    justify-content: center;
  }
  :host .page-content > ::content section > div {
    flex: 1;
    display: flex;
    align-items: stretch;
    flex-direction: column;
    flex-grow: 1;
  }
  </style>
  <template>
    <section class="body row scroll-y">
      <div class="page-content">
        <content></content>
      </div>
    </section>
  </template>
</dom-module>
<script type="text/javascript">
  Polymer({
    is : 'px-page',
    properties : {
      title : {
        type : String,
        value: null
      },

      backText:{
        type: String,
        value: null
      },

      backLink:{
        type: String,
        value: null
      },

      //Path to remote view that will be loaded
      href:{
        type: String,
        notify: true,
        value: null,
        observer: '_tmplChanged'
      },

      active : {
        type : Boolean,
        value : false,
      },

      context : {
        type : Object
      }
    },

    created : function() {
      var logger = new px.mobile.Logger(this.tagName, {colors: {debug: 'color:orange'}});
      px.mobile.utils.addMixin(logger, this);

      this.logApi('created', this.id);
    },
    ready : function() {
      this.logApi('ready', this.id);
    },
    show: function(){
      console.warn('INFO', 'show view', this.id);
      this.toggleClass('current', false, this);
    },
    hide: function(){
      console.warn('INFO', 'hide view', this.id);
      this.toggleClass('hidden', true, this);
    },
    update: function(){
      console.warn('INFO', 'update view', this.id);
    },
    currentView: function(){
      console.warn('INFO', 'current view', this.id);
      this.child()[0].toggleClass('current', true, this);
    },
    nextView: function(){
      console.warn('INFO', 'next view', this.id);
      this.toggleClass('next', true, this);
    },
    previousView: function(){
      console.warn('INFO', 'previous view', this.id);
      this.toggleClass('previous', true, this);
    },
    contextChanged : function(newContext, oldContext) {
      console.warn('contextChanged', newContext, oldContext);
    },

    //I handle loading a page from a url
    _tmplChanged: function(newVal, oldVal){
      var _this = this, html = '';
      if(newVal){
      	console.warn(this.id, 'Load remote html', newVal);


        this.importHref(newVal, function(e) {
        	html = e.target.import.body.innerHTML;
        	_this.logApi('inject html', _this.id);
          console.warn('inject px-view html', _this.id);
          _this.html(html);
        }, function(e) {
            // loading error
            console.error('Error loading page', e);
        });
      }
    },
    showMenu:function(){
      px.mobile.dom('px-app').toggleClass('show-menu');
    }
  });

</script>
